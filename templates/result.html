<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MCQ Quiz App Result</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <div class="container">
        <div class="result-header">
            <h1>MCQ Quiz App Result</h1>
            <p>Thank you, <strong>{{ name }}</strong> (<a href="mailto:{{ email }}">{{ email }}</a>)!</p>
            <p><strong>Your score:</strong> {{ score }} out of {{ total }}</p>
            <p><strong>Percentage score:</strong> {{ percentage }}%</p>
            <p><strong>Attempt ID:</strong> {{ attempt_id }}</p>
        </div>
        
        <h2>Review your answers:</h2>
        <div class="results">
            {% for question_index, result in enumerate(results) %}
                <div class="result-block {% if result.user_answer == result.correct_answer %}correct{% else %}incorrect{% endif %}">
                    <p class="question"><strong>{{ question_index + 1 }}. {{ result.question }}</strong></p>
                    <div class="options">
                        {% for option_index, (option_label, option_text) in enumerate(result.shuffled_options) %}
                            <label class="option-container">
                                <input type="radio" id="q{{ question_index }}_o{{ option_index }}" name="answer{{ question_index }}" value="{{ option_label }}"
                                {% if option_label == result.user_answer %}checked{% endif %} disabled>
                                <span class="option-label">{{ option_text | safe }}</span>
                                {% if option_label == result.correct_answer %}
                                    <span class="correct-answer">✔</span>
                                {% elif option_label == result.user_answer %}
                                    <span class="incorrect-answer">✘</span>
                                {% endif %}
                            </label>
                        {% endfor %}
                    </div>
                    <p class="feedback">{{ result.feedback }}</p>
                </div>
            {% endfor %}
        </div>
        <a href="{{ url_for('start') }}" class="button">Try again</a>
    </div>
</body>
</html>
